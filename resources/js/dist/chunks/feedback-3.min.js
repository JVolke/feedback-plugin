(self.webpackChunkplentymarkets_feedback=self.webpackChunkplentymarkets_feedback||[]).push([[3],{8533:function(e,t,a){"use strict";var s=a(2092).forEach,i=a(9341)("forEach");e.exports=i?[].forEach:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}},2092:function(e,t,a){var s=a(9974),i=a(8361),n=a(7908),r=a(7466),o=a(5417),c=[].push,l=function(e){var t=1==e,a=2==e,l=3==e,d=4==e,u=6==e,f=7==e,b=5==e||u;return function(p,k,v,m){for(var g,h,_=n(p),C=i(_),y=s(k,v,3),F=r(C.length),w=0,$=m||o,R=t?$(p,F):a||f?$(p,0):void 0;F>w;w++)if((b||w in C)&&(h=y(g=C[w],w,_),e))if(t)R[w]=h;else if(h)switch(e){case 3:return!0;case 5:return g;case 6:return w;case 2:c.call(R,g)}else switch(e){case 4:return!1;case 7:c.call(R,g)}return u?-1:l||d?d:R}};e.exports={forEach:l(0),map:l(1),filter:l(2),some:l(3),every:l(4),find:l(5),findIndex:l(6),filterOut:l(7)}},1194:function(e,t,a){var s=a(7293),i=a(5112),n=a(7392),r=i("species");e.exports=function(e){return n>=51||!s((function(){var t=[];return(t.constructor={})[r]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},9341:function(e,t,a){"use strict";var s=a(7293);e.exports=function(e,t){var a=[][e];return!!a&&s((function(){a.call(null,t||function(){throw 1},1)}))}},5417:function(e,t,a){var s=a(111),i=a(3157),n=a(5112)("species");e.exports=function(e,t){var a;return i(e)&&("function"!=typeof(a=e.constructor)||a!==Array&&!i(a.prototype)?s(a)&&null===(a=a[n])&&(a=void 0):a=void 0),new(void 0===a?Array:a)(0===t?0:t)}},6135:function(e,t,a){"use strict";var s=a(7593),i=a(3070),n=a(9114);e.exports=function(e,t,a){var r=s(t);r in e?i.f(e,r,n(0,a)):e[r]=a}},8324:function(e){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},3157:function(e,t,a){var s=a(4326);e.exports=Array.isArray||function(e){return"Array"==s(e)}},7066:function(e,t,a){"use strict";var s=a(9670);e.exports=function(){var e=s(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},6091:function(e,t,a){var s=a(7293),i=a(1361);e.exports=function(e){return s((function(){return!!i[e]()||"​᠎"!="​᠎"[e]()||i[e].name!==e}))}},3111:function(e,t,a){var s=a(4488),i="["+a(1361)+"]",n=RegExp("^"+i+i+"*"),r=RegExp(i+i+"*$"),o=function(e){return function(t){var a=String(s(t));return 1&e&&(a=a.replace(n,"")),2&e&&(a=a.replace(r,"")),a}};e.exports={start:o(1),end:o(2),trim:o(3)}},7908:function(e,t,a){var s=a(4488);e.exports=function(e){return Object(s(e))}},1361:function(e){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},2222:function(e,t,a){"use strict";var s=a(2109),i=a(7293),n=a(3157),r=a(111),o=a(7908),c=a(7466),l=a(6135),d=a(5417),u=a(1194),f=a(5112),b=a(7392),p=f("isConcatSpreadable"),k=9007199254740991,v="Maximum allowed index exceeded",m=b>=51||!i((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),g=u("concat"),h=function(e){if(!r(e))return!1;var t=e[p];return void 0!==t?!!t:n(e)};s({target:"Array",proto:!0,forced:!m||!g},{concat:function(e){var t,a,s,i,n,r=o(this),u=d(r,0),f=0;for(t=-1,s=arguments.length;t<s;t++)if(h(n=-1===t?r:arguments[t])){if(f+(i=c(n.length))>k)throw TypeError(v);for(a=0;a<i;a++,f++)a in n&&l(u,f,n[a])}else{if(f>=k)throw TypeError(v);l(u,f++,n)}return u.length=f,u}})},7327:function(e,t,a){"use strict";var s=a(2109),i=a(2092).filter;s({target:"Array",proto:!0,forced:!a(1194)("filter")},{filter:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},9554:function(e,t,a){"use strict";var s=a(2109),i=a(8533);s({target:"Array",proto:!0,forced:[].forEach!=i},{forEach:i})},1249:function(e,t,a){"use strict";var s=a(2109),i=a(2092).map;s({target:"Array",proto:!0,forced:!a(1194)("map")},{map:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},9714:function(e,t,a){"use strict";var s=a(1320),i=a(9670),n=a(7293),r=a(7066),o="toString",c=RegExp.prototype,l=c.toString,d=n((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),u=l.name!=o;(d||u)&&s(RegExp.prototype,o,(function(){var e=i(this),t=String(e.source),a=e.flags;return"/"+t+"/"+String(void 0===a&&e instanceof RegExp&&!("flags"in c)?r.call(e):a)}),{unsafe:!0})},3210:function(e,t,a){"use strict";var s=a(2109),i=a(3111).trim;s({target:"String",proto:!0,forced:a(6091)("trim")},{trim:function(){return i(this)}})},4747:function(e,t,a){var s=a(7854),i=a(8324),n=a(8533),r=a(8880);for(var o in i){var c=s[o],l=c&&c.prototype;if(l&&l.forEach!==n)try{r(l,"forEach",n)}catch(e){l.forEach=n}}},9792:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return p}});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"feedback-container"},[a("div",{staticClass:"title"},[e._v("\n    "+e._s(e.$translate("Feedback::Feedback.customerReviews"))+"\n    "),a("small",{staticClass:"feedback-average-count"},[e._v(" ("+e._s(e.counts.ratingsCountTotal)+")")])]),e._v(" "),a("div",{staticClass:"feedback-stars-average"},[a("div",{staticClass:"feedback-stars-background clearfix"},e._l(5,(function(e){return a("div",{key:"feedback_stars_background"+e,staticClass:"feedback-star"},[a("i",{staticClass:"fa fa-star"})])})),0),e._v(" "),a("div",{staticClass:"feedback-stars-overlay-wrap",style:{width:100*e.counts.averageValue/5+"%"}},[a("div",{staticClass:"feedback-stars-overlay clearfix"},e._l(5,(function(e){return a("div",{key:"feedback_stars_overlay_"+e,staticClass:"feedback-star"},[a("i",{staticClass:"fa fa-star"})])})),0)])]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"row my-2",class:e.classes,style:e.styles},[a("div",{staticClass:"col-sm-6"},[a("div",{staticClass:"feedback-bars"},[a("div",{staticClass:"feedback-bar-wrap"},[e._m(0),e._v(" "),a("div",{staticClass:"feedback-bar"},[a("div",{staticClass:"feedback-bar-fill bg-primary bg-appearance",style:{width:e.counts.ratingsCountOf5/e.counts.highestCount*100+"%"}})]),e._v(" "),a("p",{staticClass:"feedback-bar-text-after"},[e._v("\n            "+e._s(e.counts.ratingsCountOf5)+"\n          ")])]),e._v(" "),a("div",{staticClass:"feedback-bar-wrap"},[e._m(1),e._v(" "),a("div",{staticClass:"feedback-bar"},[a("div",{staticClass:"feedback-bar-fill bg-primary bg-appearance",style:{width:e.counts.ratingsCountOf4/e.counts.highestCount*100+"%"}})]),e._v(" "),a("p",{staticClass:"feedback-bar-text-after"},[e._v("\n            "+e._s(e.counts.ratingsCountOf4)+"\n          ")])]),e._v(" "),a("div",{staticClass:"feedback-bar-wrap"},[e._m(2),e._v(" "),a("div",{staticClass:"feedback-bar"},[a("div",{staticClass:"feedback-bar-fill bg-primary bg-appearance",style:{width:e.counts.ratingsCountOf3/e.counts.highestCount*100+"%"}})]),e._v(" "),a("p",{staticClass:"feedback-bar-text-after"},[e._v("\n            "+e._s(e.counts.ratingsCountOf3)+"\n          ")])]),e._v(" "),a("div",{staticClass:"feedback-bar-wrap"},[e._m(3),e._v(" "),a("div",{staticClass:"feedback-bar"},[a("div",{staticClass:"feedback-bar-fill bg-primary bg-appearance",style:{width:e.counts.ratingsCountOf2/e.counts.highestCount*100+"%"}})]),e._v(" "),a("p",{staticClass:"feedback-bar-text-after"},[e._v("\n            "+e._s(e.counts.ratingsCountOf2)+"\n          ")])]),e._v(" "),a("div",{staticClass:"feedback-bar-wrap"},[e._m(4),e._v(" "),a("div",{staticClass:"feedback-bar"},[a("div",{staticClass:"feedback-bar-fill bg-primary bg-appearance",style:{width:e.counts.ratingsCountOf1/e.counts.highestCount*100+"%"}})]),e._v(" "),a("p",{staticClass:"feedback-bar-text-after"},[e._v("\n            "+e._s(e.counts.ratingsCountOf1)+"\n          ")])])])]),e._v(" "),a("div",{staticClass:"col-sm-6"},[e.isLoading?e._e():a("feedback-form",{attrs:{"variation-id":e.variationId,"authenticated-user":e.authenticatedUser,options:e.optionsForm},on:{"feedback-added":function(t){return e.onFeedbackAdded(t)}}})],1)]),e._v(" "),a("hr"),e._v(" "),a("feedback-list",{attrs:{feedbacks:e.authenticatedUser.feedbacks,"is-last-page":!0,"authenticated-user":e.authenticatedUser,"item-attributes":e.itemAttributes,"show-controls":!0,classes:e.classes,styles:e.styles,options:e.optionsList},on:{delete:function(t){return e.showDeleteConfirmation(t)}}}),e._v(" "),a("feedback-list",{attrs:{feedbacks:e.feedbacks,"is-last-page":e.isLastPage,"authenticated-user":e.authenticatedUser,"item-attributes":e.itemAttributes,"show-controls":!1,classes:e.classes,styles:e.styles,options:e.optionsList},on:{"load-more":function(t){return e.loadFeedbacks()},delete:function(t){return e.showDeleteConfirmation(t)}}}),e._v(" "),e.isLoading?a("p",{staticClass:"loading-hint"},[e._v("\n    "+e._s(e.$translate("Feedback::Feedback.loadingFeedbacks"))+"\n  ")]):e._e(),e._v(" "),a("div",{ref:"confirmDeleteModal",staticClass:"modal fade",attrs:{tabindex:"-1",role:"dialog","aria-labelledby":"feedbackConfirmDeleteLabel-"+e._uid,"aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[e._m(5),e._v(" "),a("span",{staticClass:"modal-title h5",attrs:{id:"feedbackConfirmDeleteLabel-"+e._uid}},[e._v(e._s(e.$translate("Feedback::Feedback.deleteConfirm")))])]),e._v(" "),a("div",{staticClass:"modal-body"},[e.feedbackToDelete&&e.feedbackToDelete.isReply?a("p",{staticClass:"feedback-delete-confirmation"},[e._v("\n            "+e._s(e.$translate("Feedback::Feedback.deleteReply"))+"\n          ")]):a("p",{staticClass:"feedback-delete-confirmation"},[e._v("\n            "+e._s(e.$translate("Feedback::Feedback.deleteReview"))+"\n          ")])]),e._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[e._v("\n            "+e._s(e.$translate("Feedback::Feedback.cancel"))+"\n          ")]),e._v(" "),a("button",{staticClass:"btn btn-primary btn-appearance",attrs:{type:"button"},on:{click:function(t){return e.deleteFeedback()}}},[e._v("\n            "+e._s(e.$translate("Feedback::Feedback.yesDeleteIt"))+"\n          ")])])])])]),e._v(" "),e.counts.ratingsCountTotal>0?a("script",{attrs:{type:"application/ld+json"},domProps:{innerHTML:e._s(e.jsonld)}}):e._e()],1)};s._withStripped=!0,a(2222),a(7327),a(9554),a(1249),a(1539),a(9714),a(3210),a(4747);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.authenticatedUser.isLoggedIn||e.options.allowGuestFeedbacks?a("div",{staticClass:"createFeedback"},[a("div",{staticClass:"stars"},[e._l(5,(function(t){return a("input",{directives:[{name:"model",rawName:"v-model",value:e.feedback.ratingValue,expression:"feedback.ratingValue"}],key:"star_input_"+t,class:"star star-"+t,attrs:{id:"star-"+t+e._uid,type:"radio",name:"ratingValue"+e._uid},domProps:{value:t,checked:e._q(e.feedback.ratingValue,t)},on:{change:function(a){return e.$set(e.feedback,"ratingValue",t)}}})})),e._v(" "),e._l(5,(function(t){return a("label",{key:"star_label_"+t,class:"star star-"+t,attrs:{for:"star-"+t+e._uid}})}))],2),e._v(" "),e.ratingMissing&&!e.options.allowNoRatingFeedback?a("p",{staticClass:"feedback-error alert alert-danger"},[e._v("\n      "+e._s(e.$translate("Feedback::Feedback.ratingRequired"))+"\n    ")]):e._e(),e._v(" "),!e.authenticatedUser.isLoggedIn&&e.options.allowGuestFeedbacks?a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.feedback.authorName,expression:"feedback.authorName"}],staticClass:"form-control",attrs:{id:"author",type:"text",name:"author",placeholder:e.$translate("Feedback::Feedback.authorName"),disabled:e.authenticatedUser.limitReached||!e.authenticatedUser.hasPurchased},domProps:{value:e.feedback.authorName},on:{input:function(t){t.target.composing||e.$set(e.feedback,"authorName",t.target.value)}}}),e._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:e.feedback.honeypot,expression:"feedback.honeypot"}],staticClass:"form-control",attrs:{id:"feedback-textfield",type:"text",name:"feedback-textfield"},domProps:{value:e.feedback.honeypot},on:{input:function(t){t.target.composing||e.$set(e.feedback,"honeypot",t.target.value)}}})]):e._e(),e._v(" "),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.feedback.title,expression:"feedback.title"}],staticClass:"form-control",class:{"is-invalid":e.titleMissing},attrs:{id:"title",type:"text",name:"title",placeholder:e.$translate("Feedback::Feedback.title"),disabled:e.authenticatedUser.limitReached||!e.authenticatedUser.hasPurchased},domProps:{value:e.feedback.title},on:{input:function(t){t.target.composing||e.$set(e.feedback,"title",t.target.value)}}}),e._v(" "),a("div",{staticClass:"invalid-feedback"},[e._v("\n        "+e._s(e.$translate("Feedback::Feedback.titleRequired"))+"\n      ")])]),e._v(" "),a("div",{staticClass:"form-group"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.feedback.message,expression:"feedback.message"}],staticClass:"form-control",attrs:{id:"message",name:"message",rows:"3",placeholder:e.$translate("Feedback::Feedback.reviewMessage"),disabled:e.authenticatedUser.limitReached||!e.authenticatedUser.hasPurchased},domProps:{value:e.feedback.message},on:{input:function(t){t.target.composing||e.$set(e.feedback,"message",t.target.value)}}})]),e._v(" "),e.authenticatedUser.limitReached?a("div",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"feedback-tooltip-wrapper",attrs:{"data-toggle":"tooltip","data-placement":"top","data-original-title":e.$translate("Feedback::Feedback.maximumNumberOfFeedbacksReached")}},[a("button",{staticClass:"btn btn-primary btn-appearance",attrs:{disabled:""}},[e._v("\n        "+e._s(e.$translate("Feedback::Feedback.submitReview"))+"\n      ")])]):e.authenticatedUser.hasPurchased?a("button",{staticClass:"btn btn-primary btn-appearance",attrs:{disabled:e.isLoading},on:{click:function(t){return e.createFeedback()}}},[e._v("\n      "+e._s(e.$translate("Feedback::Feedback.submitReview"))+"\n    ")]):a("div",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"feedback-tooltip-wrapper",attrs:{"data-toggle":"tooltip","data-placement":"top","data-original-title":e.$translate("Feedback::Feedback.errorDoesntOwnProduct")}},[a("button",{staticClass:"btn btn-primary btn-appearance",attrs:{disabled:""}},[e._v("\n        "+e._s(e.$translate("Feedback::Feedback.submitReview"))+"\n      ")])])]):a("div",[a("div",{staticClass:"alert alert-info"},[e._v("\n      "+e._s(e.$translate("Feedback::Feedback.logInCustomerReviews"))+"\n    ")]),e._v(" "),a("a",{staticClass:"btn btn-primary btn-appearance",attrs:{"data-toggle":"modal",href:"#login"},on:{click:function(t){return e.createLoginModal()}}},[a("span",[e._v(e._s(e.$translate("Feedback::Feedback.login")))]),e._v(" "),a("i",{staticClass:"fa fa-user",attrs:{"aria-hidden":"true"}})])])])};i._withStripped=!0;var n={props:{variationId:String,authenticatedUser:Object,options:Object},data:function(){return{feedback:{ratingValue:0,authorName:"",title:"",message:"",type:"review",targetId:this.variationId,honeypot:""},isLoading:!1,titleMissing:!1,ratingMissing:!1}},methods:{createFeedback:function(){if(!(this.isLoading||this.feedback.honeypot.length>0))if(!this.options.allowNoRatingFeedback&&this.feedback.ratingValue<=0)this.ratingMissing=!0;else if(this.feedback.title){this.isLoading=!0,this.feedback.options=this.options;var e=this;$.ajax({type:"POST",url:"/rest/feedbacks/feedback/create",data:this.feedback,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",xhrFields:{withCredentials:!0},success:function(t){e.$emit("feedback-added",t),e.isLoading=!1,e.feedback.authorName="",e.feedback.message="",e.feedback.title="",e.feedback.ratingValue=0,e.titleMissing=!1,e.ratingMissing=!1},error:function(t,a,s){console.error(s),e.isLoading=!1}})}else this.titleMissing=!0},createLoginModal:function(){this.$store.dispatch("loadComponent","login-modal")}}},r=a(1900),o=(0,r.Z)(n,i,[],!1,null,null,null);o.options.__file="resources/js/src/app/components/item/singleitem/FeedbackForm.vue";var c=o.exports,l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback-list"},[e._l(e.feedbacks,(function(t){return a("feedback-list-entry",{key:t.id,attrs:{feedback:t,"authenticated-user":e.authenticatedUser,"item-attributes":e.itemAttributes,"is-reply":!1,"show-controls":e.showControls,classes:e.classes,styles:e.styles,options:e.options},on:{delete:function(t){return e.$emit("delete",t)}}})})),e._v(" "),e.isLastPage?e._e():a("a",{staticClass:"btn btn-default btn-block feedback-loadmore",on:{click:function(t){return e.onLoadMoreClicked()}}},[e._v("\n    "+e._s(e.$translate("Feedback::Feedback.loadMore"))+"\n  ")])],2)};l._withStripped=!0;var d={components:{"feedback-list-entry":a(8384).Z},props:{feedbacks:Object,isLastPage:Boolean,authenticatedUser:Object,itemAttributes:Array,showControls:Boolean,classes:String,styles:String,options:Object},methods:{onLoadMoreClicked:function(){this.$emit("load-more")}}},u=(0,r.Z)(d,l,[],!1,null,null,null);u.options.__file="resources/js/src/app/components/item/singleitem/FeedbackList.vue";var f={components:{"feedback-form":c,"feedback-list":u.exports},inject:{itemId:{default:null}},props:{options:Object,classes:String,styles:String},data:function(){return{authenticatedUser:{id:0,isLoggedIn:!1,hasPurchased:!1,limitReached:!1,feedbacks:[]},counts:{},feedbacks:[],currentPage:1,lastPage:0,isLastPage:!0,isLoading:!0,itemAttributes:[],feedbackToDelete:null,optionsList:{timestampVisibility:this.options.timestampVisibility,allowGuestFeedbacks:this.options.allowGuestFeedbacks},optionsForm:{allowFeedbacksOnlyIfPurchased:this.options.allowFeedbacksOnlyIfPurchased,allowNoRatingFeedback:this.options.allowNoRatingFeedback,numberOfFeedbacks:this.options.numberOfFeedbacks,allowGuestFeedbacks:this.options.allowGuestFeedbacks},jsonld:{}}},computed:{currentVariation:function(){return this.$store.getters[this.itemId+"/currentItemVariation"]},variationId:function(){return this.currentVariation&&this.currentVariation.variation.id}},mounted:function(){if(App.isShopBuilder)this.isLoading=!1;else{var e=this;$.when(this.getUser(),this.getCounts(),this.loadFeedbacks()).done((function(){e.isLoading=!1,e.generateJsonLD(),Vue.nextTick((function(){window.dispatchEvent(new Event("resize"))}))}))}},methods:{getUser:function(){var e=this;return $.ajax({type:"GET",url:"/rest/feedbacks/user/"+e.itemId+"/"+e.variationId,data:{allowFeedbacksOnlyIfPurchased:e.options.allowFeedbacksOnlyIfPurchased,numberOfFeedbacks:e.options.numberOfFeedbacks},success:function(t){e.authenticatedUser=t},error:function(e,t,a){console.error(a)}})},getCounts:function(){var e=this;return $.ajax({type:"GET",url:"/rest/feedbacks/feedback/helper/counts/"+e.itemId,success:function(t){e.counts=t.counts},error:function(e,t,a){console.error(a)}})},loadFeedbacks:function(){var e=this,t=this.currentPage++;return $.ajax({type:"GET",url:"/rest/feedbacks/feedback/helper/feedbacklist/"+e.itemId+"/"+t,data:{feedbacksPerPage:e.options.feedbacksPerPage},success:function(t){e.feedbacks=e.feedbacks.concat(t.feedbacks),e.itemAttributes=t.itemAttributes,e.lastPage=t.pagination.lastPage,e.isLastPage=t.pagination.isLastPage},error:function(e,t,a){console.error(a)}})},showDeleteConfirmation:function(e){this.feedbackToDelete=e,$(this.$refs.confirmDeleteModal).modal("show")},deleteFeedback:function(){if(null!==this.feedbackToDelete){var e=this.feedbackToDelete.feedbackId,t=this.feedbackToDelete.parentFeedbackId,a=this;$.ajax({type:"DELETE",url:"/rest/feedbacks/feedback/delete/"+e,success:function(s){function i(e,t){return e.filter((function(e){return e.id!==t}))}function n(e,t,a){return e.map((function(e){return t===e.id&&(e.replies=e.replies.filter((function(e){return e.id!==a}))),e}))}if(a.feedbackToDelete.feedbackObject.isVisible&&null===t){var r=a.feedbackToDelete.feedbackObject,o=parseInt(r.feedbackRating.rating.ratingValue);if(o>0&&o<=5){a.counts["ratingsCountOf"+o]--,a.counts.ratingsCountTotal--;var c=0;c+=5*a.counts.ratingsCountOf5,c+=4*a.counts.ratingsCountOf4,c+=3*a.counts.ratingsCountOf3,c+=2*a.counts.ratingsCountOf2,c+=1*a.counts.ratingsCountOf1,c/=a.counts.ratingsCountTotal,a.counts.averageValue=c,a.$root.$emit("averageRecalc")}}null===t?(a.feedbacks=i(a.feedbacks,e),a.authenticatedUser.feedbacks=i(a.authenticatedUser.feedbacks,e)):(a.feedbacks=n(a.feedbacks,t,e),a.authenticatedUser.feedbacks=n(a.authenticatedUser.feedbacks,t,e)),a.feedbackToDelete=null}})}$(this.$refs.confirmDeleteModal).modal("hide")},onFeedbackAdded:function(e){if(this.authenticatedUser.feedbacks.unshift(e),e.isVisible){var t=parseInt(e.feedbackRating.rating.ratingValue);if(t>0&&t<=5){this.counts["ratingsCountOf"+t]++,this.counts.ratingsCountTotal++;var a=0;a+=5*this.counts.ratingsCountOf5,a+=4*this.counts.ratingsCountOf4,a+=3*this.counts.ratingsCountOf3,a+=2*this.counts.ratingsCountOf2,a+=1*this.counts.ratingsCountOf1,a/=this.counts.ratingsCountTotal,this.counts.averageValue=a,this.$root.$emit("averageRecalc")}}},generateJsonLD:function(){if(this.counts.ratingsCountTotal>0){var e={"@context":"http://schema.org/","@type":"Product","@id":this.variationId.toString(),aggregateRating:{"@type":"AggregateRating",ratingValue:this.counts.averageValue,reviewCount:this.counts.ratingsCountTotal},review:[]};this.feedbacks.forEach((function(t){var a={"@type":"Review",author:("user"===t.sourceRelation[0].feedbackRelationType||"contact"===t.sourceRelation[0].feedbackRelationType)&&t.sourceRelation[0].feedbackRelationSourceId>0?t.sourceRelation[0].sourceRelationLabel:"0"===t.sourceRelation[0].feedbackRelationSourceId&&t.authorName.trim().length>0?t.authorName:"Anonymous",datePublished:t.createdAt,reviewBody:t.feedbackComment.comment.message,name:t.title,reviewRating:{"@type":"Rating",ratingValue:t.feedbackRating.rating.ratingValue}};e.review.push(a)}));var t=document.createElement("script");t.setAttribute("type","application/ld+json"),t.textContent=JSON.stringify(e),document.head.appendChild(t)}}}},b=(0,r.Z)(f,s,[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"feedback-bar-text-before"},[e._v("\n            5 "),a("i",{staticClass:"fa fa-star"})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"feedback-bar-text-before"},[e._v("\n            4 "),a("i",{staticClass:"fa fa-star"})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"feedback-bar-text-before"},[e._v("\n            3 "),a("i",{staticClass:"fa fa-star"})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"feedback-bar-text-before"},[e._v("\n            2 "),a("i",{staticClass:"fa fa-star"})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"feedback-bar-text-before"},[e._v("\n            1 "),a("i",{staticClass:"fa fa-star"})])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])}],!1,null,null,null);b.options.__file="resources/js/src/app/components/item/singleitem/FeedbackContainer.vue";var p=b.exports},8384:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"feedback clearfix",class:{loading:e.isLoading}},[!e.editableFeedback&&e.showControls?a("div",{staticClass:"feedback-options"},[e.feedbackData.isVisible?e._e():a("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"btn-sm btn-danger",attrs:{"data-toggle":"tooltip","data-placement":"top","data-original-title":e.$translate("Feedback::Feedback.moderationMessage")}},[a("i",{staticClass:"fa fa-eye-slash"})]),e._v(" "),e.authenticatedUser.isLoggedIn?a("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],ref:"editButton",staticClass:"btn btn-sm btn-danger",attrs:{"data-toggle":"tooltip","data-placement":"top","data-original-title":e.isReply?e.$translate("Feedback::Feedback.editReply"):e.$translate("Feedback::Feedback.editReview")},on:{click:function(t){return e.editFeedback()}}},[a("i",{staticClass:"fa fa-pencil"})]):e._e(),e._v(" "),e.authenticatedUser.isLoggedIn?a("span",{directives:[{name:"tooltip",rawName:"v-tooltip"}],staticClass:"btn btn-sm btn-danger",attrs:{"data-toggle":"tooltip","data-placement":"top","data-original-title":e.isReply?e.$translate("Feedback::Feedback.deleteReply"):e.$translate("Feedback::Feedback.deleteReview")},on:{click:function(t){return e.showDeleteConfirmation()}}},[a("i",{staticClass:"fa fa-trash-o"})]):e._e()]):e._e(),e._v(" "),e.editableFeedback?e._e():a("feedback-comment",{attrs:{feedback:e.feedbackData,"item-attributes":e.itemAttributes,"authenticated-user":e.authenticatedUser,"is-reply":e.isReply,"show-controls":e.showControls,classes:e.classes,styles:e.styles,options:e.options},on:{delete:function(t){return e.$emit("delete",t)}}}),e._v(" "),e.editableFeedback&&e.isReply?a("div",[a("div",{staticClass:"form-group"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editableFeedback.message,expression:"editableFeedback.message"}],staticClass:"form-control",attrs:{rows:"3",placeholder:e.$translate("Feedback::Feedback.replyMessage")},domProps:{value:e.editableFeedback.message},on:{input:function(t){t.target.composing||e.$set(e.editableFeedback,"message",t.target.value)}}})]),e._v(" "),a("button",{staticClass:"btn btn-primary btn-appearance",on:{click:function(t){return e.saveEditableFeedback()}}},[e._v("\n      "+e._s(e.$translate("Feedback::Feedback.editReply"))+"\n    ")]),e._v(" "),a("button",{staticClass:"btn btn-secondary feedback-edit-cancel",on:{click:function(t){e.editableFeedback=null}}},[e._v("\n      "+e._s(e.$translate("Feedback::Feedback.cancel"))+"\n    ")])]):e._e(),e._v(" "),e.editableFeedback&&!e.isReply?a("div",[e._v("\n    {% set uid = uid() %}\n    "),a("div",{staticClass:"stars"},[e._l(5,(function(t){return[a("input",{directives:[{name:"model",rawName:"v-model",value:e.editableFeedback.ratingValue,expression:"editableFeedback.ratingValue"}],key:"stars_input_"+t,class:"star star-"+t,attrs:{id:"star-"+e._uid+"-"+t,type:"radio",name:"ratingValue"},domProps:{value:t,checked:e._q(e.editableFeedback.ratingValue,t)},on:{change:function(a){return e.$set(e.editableFeedback,"ratingValue",t)}}}),e._v(" "),a("label",{key:"stars_label_"+t,class:"star star-"+t,attrs:{for:"star-"+e._uid+"-"+t}})]}))],2),e._v(" "),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.editableFeedback.title,expression:"editableFeedback.title"}],staticClass:"form-control",attrs:{type:"text",name:"title",placeholder:e.$translate("Feedback::Feedback.title"),required:""},domProps:{value:e.editableFeedback.title},on:{input:function(t){t.target.composing||e.$set(e.editableFeedback,"title",t.target.value)}}})]),e._v(" "),a("div",{staticClass:"form-group"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.editableFeedback.message,expression:"editableFeedback.message"}],staticClass:"form-control",attrs:{name:"message",rows:"3",placeholder:e.$translate("Feedback::Feedback.title")},domProps:{value:e.editableFeedback.message},on:{input:function(t){t.target.composing||e.$set(e.editableFeedback,"message",t.target.value)}}})]),e._v(" "),a("button",{staticClass:"btn btn-primary btn-appearance",on:{click:function(t){return e.saveEditableFeedback()}}},[e._v("\n      "+e._s(e.$translate("Feedback::Feedback.editReview"))+"\n    ")]),e._v(" "),a("button",{staticClass:"btn btn-secondary feedback-edit-cancel",on:{click:function(t){e.editableFeedback=null}}},[e._v("\n      "+e._s(e.$translate("Feedback::Feedback.cancel"))+"\n    ")])]):e._e()],1)};s._withStripped=!0,a(1539),a(8674);var i={name:"FeedbackListEntry",components:{"feedback-comment":function(){return a.e(2).then(a.bind(a,6927))}},props:{feedback:Object,authenticatedUser:Object,itemAttributes:Array,isReply:Boolean,showControls:Boolean,classes:String,styles:String,options:Object},data:function(){return{editableFeedback:null,isLoading:!1,feedbackData:{}}},created:function(){this.feedbackData=this.feedback},methods:{showDeleteConfirmation:function(){var e=null;this.isReply&&(e=parseInt(this.feedbackData.targetRelation.feedbackRelationTargetId)),this.$emit("delete",{feedbackId:this.feedbackData.id,isReply:this.isReply,parentFeedbackId:e,feedbackObject:this.feedbackData})},editFeedback:function(){null===this.editableFeedback&&($(this.$refs.editButton).tooltip("dispose"),this.editableFeedback={title:"",message:this.feedbackData.feedbackComment.comment.message,ratingValue:-1,isReply:this.isReply},this.isReply||(this.editableFeedback.title=this.feedbackData.title,this.editableFeedback.ratingValue=this.feedbackData.feedbackRating.rating.ratingValue))},saveEditableFeedback:function(){var e=this;if(null!==this.editableFeedback){var t=this.editableFeedback,a={message:t.message};t.isReply||(a.title=t.title,a.ratingValue=t.ratingValue),this.isLoading=!0,$.ajax({type:"PUT",url:"/rest/feedbacks/feedback/update/"+this.feedback.id,data:a,success:function(a){e.feedbackData.feedbackComment.comment.message=t.message,e.feedbackData.isVisible=a.isVisible,t.isReply||(e.feedbackData.title=t.title,e.feedbackData.feedbackRating.rating.ratingValue=t.ratingValue),e.isLoading=!1},error:function(t,a,s){console.error(s),e.isLoading=!1}})}this.editableFeedback=null}}},n=(0,a(1900).Z)(i,s,[],!1,null,null,null);n.options.__file="resources/js/src/app/components/item/singleitem/FeedbackListEntry.vue";var r=n.exports},1900:function(e,t,a){"use strict";function s(e,t,a,s,i,n,r,o){var c,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=a,l._compiled=!0),s&&(l.functional=!0),n&&(l._scopeId="data-v-"+n),r?(c=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(r)},l._ssrRegister=c):i&&(c=o?function(){i.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var d=l.render;l.render=function(e,t){return c.call(t),d(e,t)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,c):[c]}return{exports:e,options:l}}a.d(t,{Z:function(){return s}})}}]);
//# sourceMappingURL=feedback-3.min.js.map